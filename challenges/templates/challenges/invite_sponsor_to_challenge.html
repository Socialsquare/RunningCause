{% extends "masanga_base.html" %}
{% load humanize %}
{% load i18n %}
{% load staticfiles %}
{% load bootstrap3 %}

{% block title %}
{% trans "Request challenge" %}
{% endblock %}

{% block imports %}
    <script src="/static/js/bootstrap-datepicker.js"></script>
    <script type=text/javascript>
    $(document).ready(function() {
        var $challengeDatepicker = $('#challenge_datepicker');
        if($challengeDatepicker.val() === '') {
            date = new Date();
            var year = date.getFullYear();
            var month = date.getMonth() + 1; // january is 0 in this "language"
            month += 1; // give a runner at least a month
            var day = date.getDate();
            if (day < 10)
            {
                day = "0" + day;
            }
            if (month == 13)
            {
                month == 1;
                year += 1;
            }
            if (month < 10)
            {
                month = "0" + month;
            }
            
            var yearString = year + "-" + month + "-" + day;
            $challengeDatepicker.val(yearString);
        }
        $challengeDatepicker.datepicker({
            format:'yyyy-mm-dd'
        });
    });
    </script>
{% endblock %}

{% block head %}
	<div class="row">
	<div class="col-md-7 col-md-offset-1">
		{% blocktrans with username=person.username %}
		Invite {{username}} to challenge you.
		{% endblocktrans %}
	</div>
	</div>
{% endblock %}

{% block body %}

	<div class="row">
	<div class="col-md-7 col-md-offset-1">
    <p>
        {% blocktrans with username=person.username %}
        Fill out these fields to invite {{ username }} to challenge
        you to a challenge. Feel free to leave whatever you want blank. {{ username }}
        will get an email notifying him/her that you requested a challenge,
        and the values you do fill out will be displayed to him/her. The sponsor can then 
        choose to challenge you immediately, change or add some values and then
        challenge you, or decline entirely.
        {% endblocktrans %}
    </p>
    </div>
	</div>

	<div class="row">
	<div class="col-md-7  col-md-offset-1">
	<form action="{% url 'challenges:invite_sponsor_to_challenge' person_id=person.id %}" method="post">
	    {% csrf_token %}
		{% bootstrap_form form layout="form-horizontal" %}
		{% buttons %}
		  <button type="submit" class="btn btn-primary pull-right">
		    {% bootstrap_icon "star" %}{% blocktrans %}Submit{% endblocktrans %}
		  </button>
		{% endbuttons %}
	</form>
	</div>
	</div>
{% endblock %}